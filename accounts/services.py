from .models import OTP, CustomUser


# ==========================================================
# ๐ข ุฅูุดุงุก ููุฏ OTP (ูุณุฎุฉ ุงูุนุฑุถ โ Demo)
# ==========================================================
def generate_otp(phone):
    """
    ุฅูุดุงุก ููุฏ ุชุญูู ุซุงุจุช (1321) โ ูุฃุบุฑุงุถ ุงูุนุฑุถ ููุท.
    ูุชู ุญุฐู ุฃู ููุฏ ุณุงุจู ูููุณ ุงูุฑููุ ุซู ุฅูุดุงุก ููุฏ ุฌุฏูุฏ.
    """

    code = "1321"  # ๐ ููุฏ ุซุงุจุช ููุนุฑุถ ููุท

    # ุญุฐู ุฃู ุฃููุงุฏ ุณุงุจูุฉ ููุฐุง ุงูุฑูู
    OTP.objects.filter(phone=phone).delete()

    # ุฅูุดุงุก ุณุฌู OTP ุฌุฏูุฏ
    OTP.objects.create(phone=phone, code=code)

    return code  # ูุฑุฌุน ุงูููุฏ ููุชู ุนุฑุถู ุฃู ุงุณุชุฎุฏุงูู


# ==========================================================
# ๐ ุงูุชุญูู ูู ููุฏ OTP (ูุณุฎุฉ ุงูุนุฑุถ โ Demo)
# ==========================================================
def verify_otp(phone, code):
    """
    ุงูุชุญูู ูู ุตุญุฉ ุงูููุฏ ุงููุฏุฎู ููุนุฑุถ ููุท.
    ูุนุชุจุฑ ุงูููุฏ ุตุญูุญูุง ุฅุฐุง:
    - ุงูุฑูู ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    - ุงูููุฏ ูุณุงูู 1321
    """

    if code != "1321":
        return False

    otp = OTP.objects.filter(phone=phone, code="1321").first()

    return otp is not None
