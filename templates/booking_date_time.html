<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª | Beauty Salon</title>

<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}

:root{
  --gradient:linear-gradient(180deg,#5a00e6 0%,#8a2bff 40%,#c77aff 75%,#f3cbff 100%);
  --glass:rgba(255,255,255,.14);
  --glass-hover:rgba(255,255,255,.22);
  --card:#fff;
  --pill:rgba(0,0,0,.35);
  --mint:#00d5c3;
  --mint-h:#00c5b4;
}

body{
  font-family:"Tajawal",sans-serif;
  background:var(--gradient);
  min-height:100vh;
  padding:20px 16px 90px;
  color:#fff;
  animation:fade .6s ease;
  overflow-x:hidden;
}
@keyframes fade{
  from{opacity:0;transform:translateY(20px);}
  to{opacity:1;transform:translateY(0);}
}

.screen{
  width:100%;
  max-width:420px;
  margin:auto;
  text-align:center;
  position:relative;
}

/* Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ */
.back-btn{
  position:fixed;
  top:26px;
  right:26px;
  width:40px;height:40px;
  border-radius:50%;
  border:none;
  display:flex;align-items:center;justify-content:center;
  background:var(--glass);
  color:#fff;
  font-size:18px;
  cursor:pointer;
  backdrop-filter:blur(8px);
  box-shadow:0 4px 12px rgba(0,0,0,.25);
  transition:.25s;
  z-index:10;
}
.back-btn:hover{background:var(--glass-hover);transform:translateY(-2px);}

.logo-block{
  text-align:center;
  margin-top:60px;
  animation:fadeDown .7s ease;
}

.logo-icon svg{
  width:68px;height:68px;fill:#fff;
  filter:drop-shadow(0 4px 12px rgba(0,0,0,.18));
  transition:.3s;
}

.title{
  font-size:30px;
  font-weight:800;
  margin-top:6px;
}

.sub{
  font-size:13px;
  opacity:.85;
  letter-spacing:3px;
  margin-top:-8px;
}

@keyframes fadeDown{
  from{opacity:0;transform:translateY(-20px);}
  to{opacity:1;transform:translateY(0);}
}

.step-title h2{font-size:22px;font-weight:800;margin-bottom:4px;}
.step-title p{font-size:14px;opacity:.9;margin-bottom:18px;}

.calendar-card{
  background:var(--card);
  color:#1b1360;
  border-radius:24px;
  padding:18px;
  width:92%;
  margin:auto;
  box-shadow:0 10px 28px rgba(0,0,0,.25);
}

.cal-header{
  display:flex;justify-content:space-between;align-items:center;
  font-size:16px;font-weight:700;
}

.cal-nav-btn{
  background:none;border:none;
  font-size:20px;color:#5a00e6;
  cursor:pointer;transition:.25s;
}
.cal-nav-btn:hover{transform:scale(1.15);}

.cal-grid{
  display:grid;grid-template-columns:repeat(7,1fr);
  gap:4px;margin-top:10px;text-align:center;font-size:12px;
}
.cal-day-name{opacity:.6;font-weight:600;padding:4px 0;}
.cal-day{
  padding:7px 0;border-radius:50%;cursor:pointer;transition:.2s;
}
.cal-day:hover{background:#eee3ff;}
.cal-day.selected{
  background:#8a2bff;color:#fff;
  transform:scale(1.08);
  box-shadow:0 6px 14px rgba(122,29,255,.45);
}

.times-section{margin-top:22px;}
.times-section h3{font-size:17px;margin-bottom:10px;}

.times-grid{
  display:flex;flex-wrap:wrap;gap:10px;
  justify-content:center;
}

.time-pill{
  padding:8px 18px;border-radius:999px;
  background:var(--pill);color:#fff;border:none;
  cursor:pointer;transition:.25s;font-size:14px;
}
.time-pill:hover{background:var(--glass-hover);transform:translateY(-2px);}
.time-pill.selected{
  background:#8a2bff;
  transform:translateY(-2px) scale(1.05);
}
.time-pill.disabled{opacity:.3;cursor:not-allowed;}

.confirm-btn{
  width:92%;padding:14px;border-radius:999px;
  background:var(--mint);color:#003c3a;
  font-size:17px;font-weight:800;
  margin:26px auto 0;
  opacity:.4;cursor:not-allowed;border:none;
  transition:.25s;
}
.confirm-btn.ready{
  opacity:1;cursor:pointer;
  box-shadow:0 10px 22px rgba(0,0,0,.25);
}
.confirm-btn.ready:hover{
  background:var(--mint-h);
  transform:translateY(-2px);
}
</style>
</head>

<body>

<!-- Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ -->
<a href="{% url 'bookings:select_service' %}" class="back-btn">â†</a>

<div class="screen">

  <div class="logo-block">
    <div class="logo-icon">
      <svg viewBox="0 0 64 64">
        <path d="M32 4c-4 6-6 10-6 14s2 8 6 8 6-4 6-8-2-8-6-14zm0 20c-6-4-10-6-14-6s-8 2-8 6 4 6 8 6 8-2 14-6zm0 0c6-4 10-6 14-6s8 2 8 6-4 6-8 6-8-2-14-6zm0 4c-4 6-6 10-6 14s2 8 6 8 6-4 6-8-2-8-6-14z"/>
      </svg>
    </div>
    <div class="title">Beauty Salon</div>
    <div class="sub">BEAUTY</div>
  </div>

  <div class="step-title">
    <h2>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¹Ø¯</h2>
    <p>Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</p>
  </div>

  <!-- ğŸ”¥ Ø¥ØµÙ„Ø§Ø­ Ù…Ù‡Ù…: Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù†ÙØ³ View -->
  <form method="POST" action="{% url 'bookings:select_date_time' %}">
    {% csrf_token %}

    <div class="calendar-card">
      <div class="cal-header">
        <button type="button" class="cal-nav-btn" onclick="prevMonth()">â€¹</button>
        <span id="monthLabel">â€”</span>
        <button type="button" class="cal-nav-btn" onclick="nextMonth()">â€º</button>
      </div>
      <div class="cal-grid" id="calendarGrid"></div>
    </div>

    <div class="times-section">
      <h3>Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h3>
      <div class="times-grid" id="timesGrid">
        {% for t in times %}
          <button type="button" class="time-pill">{{ t.time|time:"H:i" }}</button>
        {% endfor %}
      </div>
    </div>

    <input type="hidden" name="date" id="selectedDateInput">
    <input type="hidden" name="time" id="selectedTimeInput">

    <button class="confirm-btn" id="confirmBtn" disabled>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</button>
  </form>

</div>

<script>
let current = new Date();
let selectedDate = null;
let selectedTime = null;

const grid       = document.getElementById("calendarGrid");
const monthLabel = document.getElementById("monthLabel");
const confirmBtn = document.getElementById("confirmBtn");
const dateInput  = document.getElementById("selectedDateInput");
const timeInput  = document.getElementById("selectedTimeInput");

function renderCal(){
  grid.innerHTML = "";

  const y = current.getFullYear();
  const m = current.getMonth();

  monthLabel.textContent = current.toLocaleString("ar",{month:"long",year:"numeric"});

  const first = new Date(y,m,1).getDay();
  const days  = new Date(y,m+1,0).getDate();

  const names = ["Ø£Ø­Ø¯","Ø¥Ø«Ù†","Ø«Ù„Ø«","Ø£Ø±Ø¨Ø¹","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"];
  names.forEach(n=>{
    const el=document.createElement("div");
    el.className="cal-day-name";
    el.textContent=n;
    grid.appendChild(el);
  });

  for(let i=0;i<first;i++){
    const empty=document.createElement("div");
    grid.appendChild(empty);
  }

  for(let d=1; d<=days; d++){
    const el=document.createElement("div");
    el.className="cal-day";
    el.textContent=d;

    el.onclick=()=>{
      document.querySelectorAll(".cal-day").forEach(x=>x.classList.remove("selected"));
      el.classList.add("selected");
      selectedDate = `${y}-${String(m+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;
      dateInput.value = selectedDate;
      checkReady();
    };

    grid.appendChild(el);
  }
}
renderCal();

function prevMonth(){ current.setMonth(current.getMonth()-1); renderCal(); }
function nextMonth(){ current.setMonth(current.getMonth()+1); renderCal(); }

document.querySelectorAll(".time-pill").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll(".time-pill").forEach(b=>b.classList.remove("selected"));
    btn.classList.add("selected");
    selectedTime = btn.textContent.trim();
    timeInput.value = selectedTime;
    checkReady();
  };
});

function checkReady(){
  if(selectedDate && selectedTime){
    confirmBtn.disabled=false;
    confirmBtn.classList.add("ready");
  }else{
    confirmBtn.disabled=true;
    confirmBtn.classList.remove("ready");
  }
}
</script>

</body>
</html>
